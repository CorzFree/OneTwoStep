{"version":3,"sources":["../../../../../assets/common/script/assets/common/script/uiVsResult.js"],"names":["uiPanel","require","mvs","GLB","cc","Class","extends","properties","loseClip","default","url","AudioClip","victoryClip","start","player","nodeDict","getComponent","setData","Game","PlayerManager","playerId","rival","active","on","quit","GameManager","result","isRivalLeave","audioEngine","play","loginServer","selfScore","rivalScore","self","jumpRecordId","jumpPos","length","Label","string","engine","leaveRoom","gamePanel","uiFunc","findUI","closeUI","destroy","node","name","lobbyShow"],"mappings":"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","file":"uiVsResult.js","sourceRoot":"../../../../../assets/common/script","sourcesContent":["var uiPanel = require(\"uiPanel\");\nvar mvs = require(\"Matchvs\");\nvar GLB = require(\"Glb\");\ncc.Class({\n    extends: uiPanel,\n\n    properties: {\n        loseClip: {\n            default: null,\n            url: cc.AudioClip\n        },\n        victoryClip: {\n            default: null,\n            url: cc.AudioClip\n        }\n    },\n\n    start() {\n        this.player = this.nodeDict[\"player\"].getComponent(\"resultPlayerIcon\");\n        this.player.setData(Game.PlayerManager.player.playerId);\n        this.rival = this.nodeDict[\"rival\"].getComponent(\"resultPlayerIcon\");\n        this.rival.setData(Game.PlayerManager.rival.playerId);\n        this.nodeDict[\"vs\"].active = false;\n        this.nodeDict[\"score\"].active = true;\n\n        this.nodeDict[\"quit\"].on(\"click\", this.quit, this);\n\n        if (Game.GameManager.result || Game.GameManager.isRivalLeave) {\n            this.nodeDict[\"lose\"].active = false;\n            this.nodeDict[\"win\"].active = true;\n            cc.audioEngine.play(this.victoryClip, false, 1);\n            Game.GameManager.loginServer();\n        } else {\n            this.nodeDict[\"lose\"].active = true;\n            this.nodeDict[\"win\"].active = false;\n            cc.audioEngine.play(this.loseClip, false, 1);\n        }\n        if (!Game.GameManager.selfScore || !Game.GameManager.rivalScore) {\n            var self = Game.PlayerManager.player;\n            var rival = Game.PlayerManager.rival;\n\n            Game.GameManager.selfScore = self.jumpRecordId + self.jumpPos.length;\n            Game.GameManager.rivalScore = rival.jumpRecordId + rival.jumpPos.length;\n        }\n        this.nodeDict[\"playerScore\"].getComponent(cc.Label).string = Game.GameManager.selfScore\n        this.nodeDict[\"rivalScore\"].getComponent(cc.Label).string = Game.GameManager.rivalScore;\n    },\n\n    quit: function() {\n        mvs.engine.leaveRoom(\"\");\n        var gamePanel = uiFunc.findUI(\"uiGamePanel\");\n        if (gamePanel) {\n            uiFunc.closeUI(\"uiGamePanel\");\n            gamePanel.destroy();\n        }\n        uiFunc.closeUI(this.node.name);\n        this.node.destroy();\n\n\n        Game.GameManager.lobbyShow();\n    }\n});\n"]}